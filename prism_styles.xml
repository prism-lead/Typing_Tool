<!-- ================================================================== -->
<!-- PRISM Survey Engine — Deliverable 3: Custom CSS/JS Styles          -->
<!-- Decipher Style XML for PRISM module                                -->
<!-- All patterns wired via ss:questionClassNames in prism_module.xml   -->
<!-- ================================================================== -->
<style name="prism_styles" label="PRISM Survey Engine Styles">

<css>
<![CDATA[
/* ================================================================== */
/* PRISM Design System — CSS                                          */
/* ================================================================== */

/* ---- Font Imports ---- */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fraunces:wght@400;600;700&display=swap');

/* ---- Design Tokens ---- */
:root {
  --prism-font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --prism-font-display: 'Fraunces', Georgia, serif;
  --prism-bg: #F5F2ED;
  --prism-cta: #6B7F4E;
  --prism-cta-hover: #5A6B42;
  --prism-cta-active: #4E5D39;
  --prism-text-primary: #1B2A4A;
  --prism-text-secondary: #4A5568;
  --prism-divider: #E2E8F0;
  --prism-error: #C53030;
  --prism-white: #FFFFFF;
  --prism-card-radius: 12px;
  --prism-pill-radius: 30px;
  --prism-shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
  --prism-shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
  --prism-transition: all 0.2s ease;
  --prism-gop-red: #F2042E;
  --prism-dem-blue: #0877C1;
  --prism-pnta-gray: #999999;
}

/* ---- Base Layout ---- */
.survey-page,
.survey-body {
  background-color: var(--prism-bg) !important;
  font-family: var(--prism-font-body) !important;
  color: var(--prism-text-primary) !important;
}

.survey-body {
  max-width: 680px;
  margin: 0 auto;
  padding: 24px 16px;
}

/* ---- Typography ---- */
.question-text,
.question-title {
  font-family: var(--prism-font-display) !important;
  font-weight: 700;
  font-size: 20px;
  line-height: 1.3;
  color: var(--prism-text-primary);
  margin-bottom: 8px;
}

.comment-text,
.question-comment {
  font-family: var(--prism-font-body) !important;
  font-size: 13px;
  color: var(--prism-text-secondary);
  margin-bottom: 16px;
}

/* ---- Error States ---- */
.error,
.hasError {
  color: var(--prism-error) !important;
  font-size: 14px;
  font-weight: 500;
}

/* ---- Question card container ---- */
.question {
  background: var(--prism-white);
  border-radius: var(--prism-card-radius);
  box-shadow: var(--prism-shadow-sm);
  padding: 24px;
  margin-bottom: 24px;
  border: none !important;
}


/* ================================================================== */
/* WELCOME SCREEN  — .prism-welcome                                    */
/* Wired via: ss:questionClassNames="prism-welcome"                    */
/* ================================================================== */
.prism-welcome {
  text-align: center;
  padding: 40px 24px;
}

.prism-welcome .prism-logo-wrap {
  margin-bottom: 24px;
}

.prism-welcome .prism-logo {
  max-width: 120px;
  height: auto;
}

.prism-welcome .prism-intro-text {
  font-family: var(--prism-font-body);
  font-size: 15px;
  line-height: 1.6;
  color: var(--prism-text-primary);
  max-width: 500px;
  margin: 0 auto 16px;
}


/* ================================================================== */
/* SECTION HEADER  — .prism-section-hdr                                */
/* ================================================================== */
.prism-section-hdr {
  background: transparent !important;
  box-shadow: none !important;
  padding: 8px 0 0 !important;
  border: none !important;
}

.prism-section-label {
  font-family: var(--prism-font-body);
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--prism-error);
}


/* ================================================================== */
/* HORIZONTAL RADIO PILLS  — .prism-hpill                              */
/* Wired via: ss:questionClassNames="prism-hpill"                      */
/* Used by: qvote, qgender                                            */
/* ================================================================== */
.prism-hpill .answers-list,
.prism-hpill .fir-answers {
  display: flex !important;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
}

.prism-hpill .element,
.prism-hpill .fir-answers .fir-cell {
  flex: 1 1 auto;
  min-width: 80px;
  max-width: 160px;
}

.prism-hpill .clickableCell,
.prism-hpill .fir-cell label {
  display: flex !important;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 14px 20px;
  background: var(--prism-white);
  border: 2px solid var(--prism-divider);
  border-radius: var(--prism-pill-radius);
  cursor: pointer;
  font-family: var(--prism-font-body);
  font-size: 15px;
  font-weight: 600;
  color: var(--prism-text-primary);
  text-align: center;
  transition: var(--prism-transition);
  box-sizing: border-box;
}

.prism-hpill .clickableCell:hover,
.prism-hpill .fir-cell label:hover {
  border-color: var(--prism-cta);
  background: rgba(107, 127, 78, 0.05);
}

.prism-hpill .clickableCell.selected,
.prism-hpill .clickableCell[class*="sel"],
.prism-hpill .fir-icon.selected + .cell-text label,
.prism-hpill .fir-cell.selected label {
  border-color: var(--prism-cta) !important;
  background: var(--prism-cta) !important;
  color: var(--prism-white) !important;
}

/* Hide native radio icon inside pills */
.prism-hpill .fir-icon {
  display: none !important;
}

/* PNTA styling for horizontal pills */
.prism-hpill .noanswer-label,
.prism-hpill .sq-noanswer {
  margin-top: 16px;
  font-size: 13px;
  color: var(--prism-pnta-gray);
}


/* ================================================================== */
/* DIGIT BOX  — .prism-digitbox                                        */
/* Wired via: ss:questionClassNames="prism-digitbox"                   */
/* Used by: qzip (5 boxes), qage (2-3 boxes)                          */
/* ================================================================== */
.prism-digitbox input[type="text"],
.prism-digitbox input[type="number"],
.prism-digitbox .text-input,
.prism-digitbox .number-input {
  width: 52px !important;
  height: 60px;
  border: 2px solid var(--prism-divider);
  border-radius: var(--prism-card-radius);
  text-align: center;
  font-family: var(--prism-font-body);
  font-size: 24px;
  font-weight: 600;
  color: var(--prism-text-primary);
  background: var(--prism-white);
  transition: var(--prism-transition);
  -moz-appearance: textfield;
  letter-spacing: 8px;
  padding: 0 8px;
}

.prism-digitbox input:focus {
  outline: none;
  border-color: var(--prism-cta);
  box-shadow: 0 0 0 3px rgba(107, 127, 78, 0.15);
}

/* Remove spinner for number inputs */
.prism-digitbox input::-webkit-outer-spin-button,
.prism-digitbox input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* For ZIP code, render wider to fit 5 chars */
.prism-digitbox input[size="5"] {
  width: 200px !important;
  letter-spacing: 16px;
}

/* For age, render narrower to fit 2-3 chars */
.prism-digitbox input[size="3"] {
  width: 120px !important;
  letter-spacing: 12px;
}

.prism-digitbox .noanswer-label,
.prism-digitbox .sq-noanswer {
  margin-top: 16px;
  font-size: 13px;
  color: var(--prism-pnta-gray);
}


/* ================================================================== */
/* CUSTOM.BALLOT  — .prism-ballot                                      */
/* Wired via: ss:questionClassNames="prism-ballot"                     */
/* Used by: q2024vote — dark sidebar with candidate names              */
/* ================================================================== */
.prism-ballot .answers-list,
.prism-ballot .fir-answers {
  display: flex !important;
  flex-direction: column;
  gap: 0;
  background: var(--prism-white);
  border-radius: var(--prism-card-radius);
  overflow: hidden;
  border: 2px solid var(--prism-divider);
}

.prism-ballot .clickableCell,
.prism-ballot .fir-cell label {
  display: flex !important;
  align-items: center;
  width: 100%;
  padding: 16px 20px;
  background: var(--prism-white);
  border-bottom: 1px solid var(--prism-divider);
  cursor: pointer;
  font-family: var(--prism-font-body);
  font-size: 15px;
  font-weight: 500;
  color: var(--prism-text-primary);
  transition: var(--prism-transition);
  box-sizing: border-box;
  position: relative;
  padding-left: 56px;
}

/* Dark sidebar marker */
.prism-ballot .clickableCell::before,
.prism-ballot .fir-cell label::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 40px;
  background: var(--prism-text-primary);
}

/* Radio circle in the dark sidebar */
.prism-ballot .fir-icon {
  position: absolute !important;
  left: 8px;
  z-index: 1;
}

.prism-ballot .fir-icon .rounded .fir-base {
  fill: rgba(255, 255, 255, 0.4) !important;
}

.prism-ballot .fir-icon.selected .rounded .fir-selected {
  fill: var(--prism-white) !important;
}

.prism-ballot .clickableCell:hover,
.prism-ballot .fir-cell label:hover {
  background: rgba(107, 127, 78, 0.05);
}

.prism-ballot .clickableCell.selected,
.prism-ballot .clickableCell[class*="sel"],
.prism-ballot .fir-cell.selected label {
  background: rgba(107, 127, 78, 0.08);
}

/* Last row no bottom border */
.prism-ballot .clickableCell:last-child,
.prism-ballot .fir-cell:last-child label {
  border-bottom: none;
}

.prism-ballot .noanswer-label,
.prism-ballot .sq-noanswer {
  margin-top: 16px;
  font-size: 13px;
  color: var(--prism-pnta-gray);
}


/* ================================================================== */
/* CUSTOM.PARTYID  — .prism-partyid                                    */
/* Wired via: ss:questionClassNames="prism-partyid"                    */
/* Used by: qparty1, qparty3 — party icons (elephant/donkey/IND)      */
/* ================================================================== */
.prism-partyid .answers-list,
.prism-partyid .fir-answers {
  display: flex !important;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
}

.prism-partyid .element,
.prism-partyid .fir-answers .fir-cell {
  flex: 1 1 auto;
  min-width: 100px;
  max-width: 180px;
}

.prism-partyid .clickableCell,
.prism-partyid .fir-cell label {
  display: flex !important;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 16px 12px;
  background: var(--prism-white);
  border: 2px solid var(--prism-divider);
  border-radius: var(--prism-card-radius);
  cursor: pointer;
  font-family: var(--prism-font-body);
  font-size: 14px;
  font-weight: 600;
  color: var(--prism-text-primary);
  text-align: center;
  transition: var(--prism-transition);
  box-sizing: border-box;
}

.prism-partyid .clickableCell:hover,
.prism-partyid .fir-cell label:hover {
  border-color: var(--prism-cta);
  background: rgba(107, 127, 78, 0.05);
}

.prism-partyid .clickableCell.selected,
.prism-partyid .clickableCell[class*="sel"],
.prism-partyid .fir-icon.selected + .cell-text label,
.prism-partyid .fir-cell.selected label {
  border-color: var(--prism-cta) !important;
  background: var(--prism-cta) !important;
  color: var(--prism-white) !important;
}

/* Party icon sizing */
.prism-party-icon {
  width: 48px;
  height: 48px;
  margin-bottom: 8px;
  object-fit: contain;
}

/* IND text circle */
.prism-ind-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: var(--prism-text-secondary);
  color: var(--prism-white);
  font-family: var(--prism-font-body);
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 8px;
}

/* Hide native radio icon */
.prism-partyid .fir-icon {
  display: none !important;
}

.prism-partyid .noanswer-label,
.prism-partyid .sq-noanswer {
  margin-top: 16px;
  font-size: 13px;
  color: var(--prism-pnta-gray);
}


/* ================================================================== */
/* PILL BUTTONS  — .prism-pill                                         */
/* Wired via: ss:questionClassNames="prism-pill"                       */
/* Used by: qparty2 — Strong / Not-so-strong                          */
/* ================================================================== */
.prism-pill .answers-list,
.prism-pill .fir-answers {
  display: flex !important;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
}

.prism-pill .element,
.prism-pill .fir-answers .fir-cell {
  flex: 0 1 auto;
}

.prism-pill .clickableCell,
.prism-pill .fir-cell label {
  display: inline-flex !important;
  align-items: center;
  justify-content: center;
  padding: 12px 32px;
  background: var(--prism-white);
  border: 2px solid var(--prism-divider);
  border-radius: var(--prism-pill-radius);
  cursor: pointer;
  font-family: var(--prism-font-body);
  font-size: 15px;
  font-weight: 500;
  color: var(--prism-text-primary);
  transition: var(--prism-transition);
}

.prism-pill .clickableCell:hover,
.prism-pill .fir-cell label:hover {
  border-color: var(--prism-cta);
  background: rgba(107, 127, 78, 0.05);
}

.prism-pill .clickableCell.selected,
.prism-pill .clickableCell[class*="sel"],
.prism-pill .fir-icon.selected + .cell-text label,
.prism-pill .fir-cell.selected label {
  border-color: var(--prism-cta) !important;
  background: var(--prism-cta) !important;
  color: var(--prism-white) !important;
}

/* Hide native radio icon */
.prism-pill .fir-icon {
  display: none !important;
}

.prism-pill .noanswer-label,
.prism-pill .sq-noanswer {
  margin-top: 16px;
  font-size: 13px;
  color: var(--prism-pnta-gray);
}


/* ================================================================== */
/* MAXDIFF GRID  — .prism-maxdiff                                      */
/* Wired via: ss:questionClassNames="prism-maxdiff"                    */
/* Used by: GOP MaxDiff, DEM MaxDiff                                   */
/* Inline <style> blocks in prism_module.xml handle header/row layout  */
/* ================================================================== */
.prism-maxdiff {
  background: var(--prism-white);
  border-radius: var(--prism-card-radius);
  box-shadow: var(--prism-shadow-sm);
  overflow: hidden;
}

.prism-maxdiff .question-text {
  font-family: var(--prism-font-body) !important;
  font-size: 15px;
  font-weight: 400;
  padding: 16px 20px;
}

.prism-maxdiff .grid-table-mode {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
}

/* Column header bar (MOST / LEAST) — styled via inline <style> in XML */
.prism-maxdiff .maxdiff-header-legend th.legend {
  padding: 12px 16px;
  text-align: center;
}

/* Item row cells */
.prism-maxdiff .maxdiff-row td.element {
  width: 60px;
  padding: 12px 8px;
  vertical-align: middle;
}

.prism-maxdiff .maxdiff-row th.row-legend {
  vertical-align: middle;
}

/* Alternating row backgrounds */
.prism-maxdiff .maxdiff-row.odd {
  background-color: rgba(245, 242, 237, 0.5);
}

.prism-maxdiff .maxdiff-row:hover {
  background-color: rgba(107, 127, 78, 0.05);
}

/* Radio styling — olive green when selected */
.prism-maxdiff .fir-icon .rounded .fir-base {
  fill: #D5D0C8;
}

.prism-maxdiff .fir-icon.selected .rounded .fir-selected {
  fill: var(--prism-cta);
}


/* ================================================================== */
/* MAXDIFF INTRO  — .prism-md-intro                                    */
/* ================================================================== */
.prism-md-intro {
  text-align: center;
  padding: 32px 24px;
}

.prism-md-intro .prism-logo-sm {
  max-width: 80px;
  height: auto;
  margin-bottom: 16px;
}

.prism-md-intro .prism-intro-text {
  font-family: var(--prism-font-body);
  font-size: 14px;
  line-height: 1.6;
  color: var(--prism-text-primary);
  max-width: 540px;
  margin: 0 auto 12px;
}


/* ================================================================== */
/* 7-PT SEMANTIC DIFFERENTIAL  — .prism-semantic                       */
/* Wired via: ss:questionClassNames="prism-semantic"                   */
/* Used by: vector_justice, vector_industry                            */
/* ================================================================== */
.prism-semantic .grid-table-mode,
.prism-semantic .answers-list {
  display: flex !important;
  align-items: center;
  justify-content: center;
  gap: 0;
  margin: 16px 0;
}

.prism-semantic .col-legend {
  font-family: var(--prism-font-body) !important;
  font-size: 11px;
  font-weight: 600;
  color: var(--prism-text-secondary);
}

/* Scale point circles */
.prism-semantic .clickableCell,
.prism-semantic .fir-cell {
  text-align: center;
  padding: 8px;
}

.prism-semantic .fir-icon {
  width: 36px !important;
  height: 36px !important;
}

.prism-semantic .fir-icon svg {
  width: 36px !important;
  height: 36px !important;
}

/* Color gradient: Strongly disagree (red) to Strongly agree (green) */
.prism-semantic .fir-cell:nth-child(1) .fir-icon.selected .rounded .fir-selected,
.prism-semantic .fir-cell:nth-child(1) .fir-icon.selected .fir-large { fill: #C62828 !important; }
.prism-semantic .fir-cell:nth-child(2) .fir-icon.selected .rounded .fir-selected,
.prism-semantic .fir-cell:nth-child(2) .fir-icon.selected .fir-large { fill: #D84315 !important; }
.prism-semantic .fir-cell:nth-child(3) .fir-icon.selected .rounded .fir-selected,
.prism-semantic .fir-cell:nth-child(3) .fir-icon.selected .fir-large { fill: #EF6C00 !important; }
.prism-semantic .fir-cell:nth-child(4) .fir-icon.selected .rounded .fir-selected,
.prism-semantic .fir-cell:nth-child(4) .fir-icon.selected .fir-large { fill: #8B8B6B !important; }
.prism-semantic .fir-cell:nth-child(5) .fir-icon.selected .rounded .fir-selected,
.prism-semantic .fir-cell:nth-child(5) .fir-icon.selected .fir-large { fill: #558B2F !important; }
.prism-semantic .fir-cell:nth-child(6) .fir-icon.selected .rounded .fir-selected,
.prism-semantic .fir-cell:nth-child(6) .fir-icon.selected .fir-large { fill: #33691E !important; }
.prism-semantic .fir-cell:nth-child(7) .fir-icon.selected .rounded .fir-selected,
.prism-semantic .fir-cell:nth-child(7) .fir-icon.selected .fir-large { fill: #1B5E20 !important; }

/* Unselected radio bases */
.prism-semantic .fir-icon .rounded .fir-base { fill: #D5D0C8 !important; }

.prism-semantic .noanswer-label,
.prism-semantic .sq-noanswer {
  margin-top: 16px;
  font-size: 13px;
  color: var(--prism-pnta-gray);
}


/* ================================================================== */
/* VECTOR INTRO  — .prism-vector-intro                                 */
/* ================================================================== */
.prism-vector-intro {
  background: transparent !important;
  box-shadow: none !important;
  text-align: center;
  padding: 16px 0 !important;
  border: none !important;
}


/* ================================================================== */
/* SEGMENT REVEAL  — .prism-reveal                                     */
/* ================================================================== */
.prism-reveal {
  text-align: center;
}

.prism-segment-reveal {
  display: flex;
  justify-content: center;
  padding: 32px 0;
}

.prism-segment-card {
  background: var(--prism-white);
  border-radius: 16px;
  box-shadow: var(--prism-shadow-md);
  padding: 40px 48px;
  text-align: center;
  max-width: 480px;
  width: 100%;
}

.prism-segment-label {
  font-family: var(--prism-font-body);
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--prism-text-secondary);
  margin-bottom: 12px;
}

.prism-segment-name {
  font-family: var(--prism-font-display);
  font-size: 28px;
  font-weight: 700;
  color: var(--prism-text-primary);
  line-height: 1.2;
  margin-bottom: 8px;
}

.prism-segment-abbrev {
  font-family: var(--prism-font-body);
  font-size: 16px;
  color: var(--prism-text-secondary);
  margin-bottom: 20px;
}

.prism-segment-confidence {
  font-family: var(--prism-font-body);
  font-size: 14px;
  color: var(--prism-text-secondary);
  padding-top: 16px;
  border-top: 1px solid var(--prism-divider);
}


/* ================================================================== */
/* PRIVACY FOOTER  — .prism-footer                                     */
/* ================================================================== */
.prism-footer {
  background: transparent !important;
  box-shadow: none !important;
  padding: 8px 0 !important;
  border: none !important;
}

.prism-privacy {
  font-family: var(--prism-font-body);
  font-size: 10px;
  color: #AAAAAA;
  text-align: center;
  margin: 0;
  padding: 12px 0;
  border-top: 1px solid var(--prism-divider);
}


/* ================================================================== */
/* NAVIGATION / CTA BUTTON                                             */
/* ================================================================== */
.survey-buttons .button,
.survey-buttons .btn-next,
.survey-buttons input[type="submit"] {
  display: inline-block;
  padding: 14px 40px;
  background: var(--prism-cta) !important;
  color: var(--prism-white) !important;
  border: none !important;
  border-radius: var(--prism-pill-radius);
  font-family: var(--prism-font-body);
  font-size: 14px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.07rem;
  cursor: pointer;
  transition: var(--prism-transition);
}

.survey-buttons .button:hover,
.survey-buttons .btn-next:hover,
.survey-buttons input[type="submit"]:hover {
  background: var(--prism-cta-hover) !important;
  box-shadow: var(--prism-shadow-sm);
}

.survey-buttons .button:active,
.survey-buttons .btn-next:active,
.survey-buttons input[type="submit"]:active {
  background: var(--prism-cta-active) !important;
}


/* ================================================================== */
/* PROGRESS BAR (comment-based counter styling)                        */
/* ================================================================== */
.question .comment-text {
  display: flex;
  justify-content: flex-end;
  font-family: var(--prism-font-body);
  font-size: 11px;
  font-weight: 500;
  color: var(--prism-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}


/* ================================================================== */
/* NOANSWER / PNTA STYLING (global)                                    */
/* ================================================================== */
.noanswer-label label,
.sq-noanswer label,
.noanswer label {
  font-family: var(--prism-font-body) !important;
  font-size: 13px !important;
  color: var(--prism-pnta-gray) !important;
  font-weight: 400 !important;
}

.noanswer .fir-icon .rounded .fir-base,
.sq-noanswer .fir-icon .rounded .fir-base {
  fill: var(--prism-pnta-gray) !important;
}


/* ================================================================== */
/* RESPONSIVE DESIGN                                                   */
/* ================================================================== */
@media (max-width: 640px) {
  .survey-body {
    padding: 16px 12px;
  }

  .question-text,
  .question-title {
    font-size: 18px !important;
  }

  .prism-hpill .clickableCell,
  .prism-hpill .fir-cell label {
    padding: 12px 16px;
    font-size: 14px;
  }

  .prism-partyid .clickableCell,
  .prism-partyid .fir-cell label {
    padding: 12px 8px;
    font-size: 13px;
  }

  .prism-party-icon {
    width: 40px;
    height: 40px;
  }

  .prism-maxdiff .maxdiff-row th.row-legend {
    font-size: 13px;
    padding: 10px 8px;
  }

  .prism-maxdiff .maxdiff-row td.element {
    width: 50px;
  }

  .prism-semantic .fir-icon,
  .prism-semantic .fir-icon svg {
    width: 30px !important;
    height: 30px !important;
  }

  .prism-segment-card {
    padding: 28px 24px;
  }

  .prism-segment-name {
    font-size: 24px;
  }

  .prism-digitbox input[size="5"] {
    width: 180px !important;
    letter-spacing: 12px;
  }

  .prism-digitbox input[size="3"] {
    width: 100px !important;
    letter-spacing: 10px;
  }
}
]]>
</css>

<js>
<![CDATA[
/* ================================================================== */
/* PRISM Survey Engine — JavaScript                                   */
/* ================================================================== */
(function() {
  'use strict';

  /* ---- Digit Box Enhancement ---- */
  /* Style ZIP and age inputs for digit-box appearance */
  function initDigitBoxes() {
    var digitQuestions = document.querySelectorAll('.prism-digitbox');
    digitQuestions.forEach(function(q) {
      var inputs = q.querySelectorAll('input[type="text"], input[type="number"]');
      inputs.forEach(function(input) {
        input.setAttribute('inputmode', 'numeric');
        input.setAttribute('autocomplete', 'off');
        input.addEventListener('focus', function() {
          this.select();
        });
      });
    });
  }

  /* ---- Party Icon Enhancement ---- */
  /* Ensure party icons inside selected buttons get white treatment */
  function initPartyIcons() {
    var partyQuestions = document.querySelectorAll('.prism-partyid');
    partyQuestions.forEach(function(q) {
      var cells = q.querySelectorAll('.clickableCell, .fir-cell');
      cells.forEach(function(cell) {
        cell.addEventListener('click', function() {
          /* Allow Decipher to process selection first */
          setTimeout(function() {
            var icons = q.querySelectorAll('.prism-party-icon');
            icons.forEach(function(icon) {
              var parent = icon.closest('.clickableCell, .fir-cell, label');
              if (parent && (parent.classList.contains('selected') ||
                             parent.className.indexOf('sel') > -1)) {
                icon.style.filter = 'brightness(0) invert(1)';
              } else {
                icon.style.filter = 'none';
              }
            });
          }, 50);
        });
      });
    });
  }

  /* ---- Initialize on DOM ready ---- */
  function init() {
    initDigitBoxes();
    initPartyIcons();
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }

  /* Re-initialize on Decipher page transitions (AJAX navigation) */
  if (typeof SST !== 'undefined' && SST.on) {
    SST.on('pageRendered', init);
  }

})();
]]>
</js>

</style>
